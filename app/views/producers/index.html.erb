<div class="big-container ml-0 mr-0 mt-2 d-flex justify-content-between">
  <div class="map-container col-12 col-lg-6 d-none d-sm-block">
     <%= render "map" %>
  </div>

  <div class="producer-container col-12 col-lg-6">
    <div class="searchbar mb-3">
      <h6>LOOKING FOR A SPECIFIC PRODUCT?</h6>
      <%= form_tag producers_path, method: :get, class: "search-bar" do %>
       <%= text_field_tag :query_product,
        params[:query_product],
        class: "form-control",
        placeholder: "Find a specific product"
        %>
        <%= submit_tag "Search", class: "btn-green" %>
    <% end %>
    </div>
    <% @producers.each do |producer| %>
    <%= link_to producer_path(producer.id) do %>
      <div class="producer-card mb-2">
        <div id="carouselExampleControls<%= producer.id %>" class="carousel slide" data-interval="false">
          <div class="carousel-inner">
            <div class="carousel-item active">
              <img class="d-block w-100" src="https://images.unsplash.com/photo-1507598641400-ec3536ba81bc?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1050&q=80" alt="First slide">
            </div>
            <div class="carousel-item">
              <img class="d-block w-100" src="https://images.unsplash.com/photo-1507844090982-e6e9452ea68d?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1047&q=80" alt="Second slide">
            </div>
            <div class="carousel-item">
              <img class="d-block w-100" src="https://images.unsplash.com/photo-1504279577054-acfeccf8fc52?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=967&q=80" alt="Third slide">
            </div>
          </div>
          <a class="carousel-control-prev" href="#carouselExampleControls<%= producer.id %>" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next" href="#carouselExampleControls<%= producer.id %>" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
      </div>
        <div class="card-infos d-flex justify-content-between">
          <div class="info flex-column">
            <div class="specific-info-name mb-1"><h4><%= link_to producer.name.upcase, producer_path(producer.id) %></h4></div>
            <% producer.products.each do |product| %>
               <div class="specific info"><p><%= product.name %></p></div>
              <!--  <% product.tags.each do |tag| %>
               <div class="specific info"><p><%= tag.name %></p></div>
               <% end %> -->
            <% end %>
          </div>
          <div class="star">
            <% if user_signed_in? %>
              <% unless producer.check_favorite?(current_user) %>
                <%= link_to user_favorites_path(current_user, producer_id: producer), method: :post, remote: true do %>
                  <%= icon('far', 'star') %>
                <% end %>
              <% else %>
                 <%= link_to user_favorite_path(current_user, Favorite.where("user_id = ? and producer_id = ?", current_user.id, producer.id).first, producer_id: producer), remote: true, method: :delete do %>
                   <%= icon('fas', 'star') %>
                <% end %>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
      <% end %>
    <% end %>
  </div>
</div>


<button type="button" class="d-lg-none d-md-none" id="map-button" data-toggle="modal" data-target="#mapModal">
  <svg width="2em" height="2em" viewBox="0 0 16 16" class="bi bi-compass" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" d="M8 15.016a6.5 6.5 0 1 0 0-13 6.5 6.5 0 0 0 0 13zm0 1a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15z"/>
  <path d="M6 1a1 1 0 0 1 1-1h2a1 1 0 0 1 0 2H7a1 1 0 0 1-1-1zm.94 6.44l4.95-2.83-2.83 4.95-4.95 2.83 2.83-4.95z"/>
</svg>
</button>

<div id="mapModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <%= render "map" %>
      <div id="modal-close-button">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <svg width="2em" height="2em" viewBox="0 0 16 16" class="bi bi-x-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-4.146-3.146a.5.5 0 0 0-.708-.708L8 7.293 4.854 4.146a.5.5 0 1 0-.708.708L7.293 8l-3.147 3.146a.5.5 0 0 0 .708.708L8 8.707l3.146 3.147a.5.5 0 0 0 .708-.708L8.707 8l3.147-3.146z"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
</div>


